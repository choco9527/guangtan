<wxs src="../../tools.wxs" module="tools"/>

<view class="detail-page">
    <van-empty wx:if="{{!detail.aid}}" image="search"/>
    <scroll-view wx:else scroll-y enable-passive>
        <image mode="aspectFill" bind:tap="goBilibili" class="head-img" src="{{detail.pic}}"></image>
        <van-cell-group border>
            <van-cell title="{{detail.title}}" use-label-slot>
                <view slot="label" class="c-label">
                    {{detail.description}}
                </view>
            </van-cell>
            <van-cell title="综合人气" value="{{ tools.getWeight(detail.v_stat) }}"/>

            <van-search shape="round" bind:search="onSearch" bind:change="onSearChange"
                        value="{{ searchVal }}" placeholder="添加地点"/>
            <view class="t-center">
                <van-loading  wx:if="{{listLoading}}">searching...</van-loading>
            </view>

            <van-transition show="{{ searchList.length>0 }}" custom-class="block">
                <van-cell-group inset>
                    <van-cell wx:for="{{searchList}}" wx:key="id"
                              title="{{item.title}}" value="{{item.city + item.district}}"
                              data-item="{{item}}" label="{{item.address}}"
                              bind:tap="onSuggestionSel"
                    />
                </van-cell-group>
            </van-transition>
            <van-cell use-label-slot>
                <map slot="label"
                     id="myMap"
                     latitude="{{latitude}}"
                     longitude="{{longitude}}"
                     markers="{{markers}}"
                     show-location
                     bindmarkertap="onMarkerTap"
                />
            </van-cell>
        </van-cell-group>
    </scroll-view>
    <van-dialog id="van-dialog" />
</view>
